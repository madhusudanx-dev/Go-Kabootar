(()=>{var e,t={380:(e,t,n)=>{var r=n(671);"string"==typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals),(0,n(918).A)("4a65fc04",r,!0,{})},459:e=>{var t=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var o=t&&t.prototype instanceof w?t:w,i=Object.create(o.prototype),s=new S(r||[]);return a(i,"_invoke",{value:E(e,n,s)}),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var p="suspendedStart",f="suspendedYield",h="executing",m="completed",v={};function w(){}function g(){}function y(){}var b={};c(b,i,(function(){return this}));var A=Object.getPrototypeOf,x=A&&A(A(B([])));x&&x!==n&&r.call(x,i)&&(b=x);var k=y.prototype=w.prototype=Object.create(b);function C(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,i,s){var l=u(e[a],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,i,s)}),(function(e){n("throw",e,i,s)})):t.resolve(d).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,s)}))}s(l.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function E(e,n,r){var a=p;return function(o,i){if(a===h)throw new Error("Generator is already running");if(a===m){if("throw"===o)throw i;return{value:t,done:!0}}for(r.method=o,r.arg=i;;){var s=r.delegate;if(s){var l=z(s,r);if(l){if(l===v)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===p)throw a=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=h;var c=u(e,n,r);if("normal"===c.type){if(a=r.done?m:f,c.arg===v)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(a=m,r.method="throw",r.arg=c.arg)}}}function z(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,z(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var o=u(a,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function $(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function B(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(typeof e+" is not iterable")}return g.prototype=y,a(k,"constructor",{value:y,configurable:!0}),a(y,"constructor",{value:g,configurable:!0}),g.displayName=c(y,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,l,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},C(_.prototype),c(_.prototype,s,(function(){return this})),e.AsyncIterator=_,e.async=function(t,n,r,a,o){void 0===o&&(o=Promise);var i=new _(d(t,n,r,a),o);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},C(k),c(k,l,"Generator"),c(k,i,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=B,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach($),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(r,a){return s.type="throw",s.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(l&&c){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),$(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;$(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:B(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},477:()=>{},671:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>s});var r=n(594),a=n.n(r),o=n(621),i=n.n(o)()(a());i.push([e.id,"\n.download-app[data-v-08482814] {\n  position: relative;\n}\n.btn-new-session[data-v-08482814] {\n  position: absolute;\n  top: -60px;\n  right: 0;\n  z-index: 10;\n}\n.files tr[data-v-08482814] {\n  transition: all 0.2s ease;\n}\n.files tr[data-v-08482814]:hover {\n  background: #f9fafb !important;\n  transform: scale(1.01);\n}\n.file-icon[data-v-08482814] {\n  width: 60px;\n  text-align: center;\n}\n.file-size[data-v-08482814] {\n  color: #6b7280;\n  font-weight: 400;\n}\n.downloaded[data-v-08482814] {\n  color: #10b981 !important;\n  font-size: 18px;\n}\n.btn-download-archive[data-v-08482814] {\n  margin-top: -5px;\n}\n.btn-download-archive .btn[data-v-08482814] {\n  margin-left: 8px;\n}\n@media (max-width: 768px) {\n.btn-new-session[data-v-08482814] {\n    position: relative;\n    top: auto;\n    right: auto;\n    margin-bottom: 20px;\n    display: block;\n    width: 100%;\n}\n}\n","",{version:3,sources:["webpack://./src/Download.vue"],names:[],mappings:";AAgSA;EACA,kBAAA;AACA;AAEA;EACA,kBAAA;EACA,UAAA;EACA,QAAA;EACA,WAAA;AACA;AAEA;EACA,yBAAA;AACA;AAEA;EACA,8BAAA;EACA,sBAAA;AACA;AAEA;EACA,WAAA;EACA,kBAAA;AACA;AAEA;EACA,cAAA;EACA,gBAAA;AACA;AAEA;EACA,yBAAA;EACA,eAAA;AACA;AAEA;EACA,gBAAA;AACA;AAEA;EACA,gBAAA;AACA;AAEA;AACA;IACA,kBAAA;IACA,SAAA;IACA,WAAA;IACA,mBAAA;IACA,cAAA;IACA,WAAA;AACA;AACA",sourcesContent:["<template lang=\"pug\">\r\n  .download-app\r\n    a.btn.btn-sm.btn-info.btn-new-session(@click='newSession()', :title='$root.lang.newUpload')\r\n      icon.fa-fw(name=\"cloud-upload-alt\")\r\n      span.hidden-xs  {{ $root.lang.newUpload }}\r\n    .alert.alert-danger(v-show=\"error\")\r\n      strong\r\n        icon.fa-fw(name=\"exclamation-triangle\")\r\n        |  {{ error }}\r\n    .well(v-if='needsPassword')\r\n      h3 {{ $root.lang.password }}\r\n      .form-group\r\n        input.form-control(type='password', v-model='password', @keyup.enter='password.length && fetchBucket()' autofocus)\r\n      p.text-danger(v-show='passwordWrong')\r\n        strong {{ $root.lang.accessDenied }}\r\n      |\r\n      button.decrypt.btn.btn-primary(:disabled='password.length<1', @click='fetchBucket()')\r\n        icon.fa-fw(name=\"key\")\r\n        |  {{ $root.lang.decrypt }}\r\n    .panel.panel-primary(v-if='!needsPassword && !loading')\r\n      .panel-heading\r\n        strong {{ $root.lang.files }}\r\n        div.pull-right.btn-group.btn-download-archive(v-if=\"downloadsAvailable\")\r\n          a.btn.btn-sm.btn-default(\r\n            @click=\"downloadAll('zip')\"\r\n            @keydown.enter.prevent=\"downloadAll('zip')\"\r\n            @keydown.space.prevent=\"downloadAll('zip')\"\r\n            :title=\"$root.lang.zipDownload\"\r\n            tabindex=\"0\"\r\n            role=\"button\"\r\n          )\r\n            icon.fa-fw(name=\"download\")\r\n            |  zip\r\n          a.btn.btn-sm.btn-default(\r\n            @click=\"downloadAll('tar.gz')\"\r\n            @keydown.enter.prevent=\"downloadAll('tar.gz')\"\r\n            @keydown.space.prevent=\"downloadAll('tar.gz')\"\r\n            :title=\"$root.lang.tarGzDownload\"\r\n            tabindex=\"0\"\r\n            role=\"button\"\r\n          )\r\n            icon.fa-fw(name=\"download\")\r\n            |  tar.gz\r\n      .panel-body\r\n        table.table.table-hover.table-striped.files\r\n          tbody\r\n            tr(\r\n              v-for='file in files',\r\n              style='cursor: pointer',\r\n              @click='download(file)',\r\n              @keydown.enter.prevent='download(file)',\r\n              @keydown.space.prevent='download(file)',\r\n              tabindex=\"0\",\r\n              role=\"button\"\r\n            )\r\n              td.file-icon\r\n                file-icon(:file='file')\r\n              td\r\n                div.pull-right.btn-group\r\n                  clipboard.btn.btn-sm.btn-default(:value='baseURI + file.url', @change='copied(file, $event)', :title='$root.lang.copyToClipboard')\r\n                    a\r\n                      icon(name=\"copy\")\r\n                  a.btn.btn-sm.btn-default(:title=\"$root.lang.preview\", @click.prevent.stop=\"preview=file\", v-if=\"file.previewType\")\r\n                    icon(name=\"eye\")\r\n                i.pull-right.fa.fa-check.text-success.downloaded(v-show='file.downloaded')\r\n                p\r\n                  strong {{ file.metadata.name }}\r\n                  small.file-size(v-if=\"isFinite(file.size)\") ({{ humanFileSize(file.size) }})\r\n                p {{ file.metadata.comment }}\r\n\r\n    preview-modal(:preview=\"preview\", :files=\"previewFiles\", :max-size=\"config.maxPreviewSize\", @close=\"preview=false\")\r\n\r\n</template>\r\n\r\n\r\n<script>\r\n  \"use strict\";\r\n  import MD5 from 'crypto-js/md5';\r\n\r\n  import FileIcon from './common/FileIcon.vue';\r\n  import Clipboard from './common/Clipboard.vue';\r\n  import PreviewModal from './Upload/Download/PreviewModal.vue';\r\n\r\n  import 'vue-awesome/icons/cloud-upload-alt';\r\n  import 'vue-awesome/icons/exclamation-triangle';\r\n  import 'vue-awesome/icons/copy';\r\n  import 'vue-awesome/icons/check';\r\n  import 'vue-awesome/icons/download';\r\n  import 'vue-awesome/icons/key';\r\n  import 'vue-awesome/icons/eye';\r\n\r\n  function getPreviewType(file, maxSize) {\r\n    if(!file || !file.metadata) return false;\r\n    if(file.metadata.retention === 'one-time') return false;\r\n    // no preview for files size > 2MB\r\n    if(file.size > maxSize) return false;\r\n    if(file.metadata.type && file.metadata.type.match(/^image\\/.*/)) return 'image';\r\n    else if(file.metadata.type && file.metadata.type.match(/(text\\/|xml|json|javascript|x-sh)/)\r\n      || file.metadata.name && file.metadata.name\r\n        .match(/\\.(jsx|vue|sh|pug|less|scss|sass|c|h|conf|log|bat|cmd|lua|class|java|py|php|yml|sql|md)$/)) {\r\n      return 'text';\r\n    }\r\n    return false;\r\n  }\r\n\r\n  export default {\r\n    name: 'app',\r\n    components: { FileIcon, Clipboard, PreviewModal },\r\n    data () {\r\n      return {\r\n        files: [],\r\n        sid: document.location.pathname.match(/^.*\\/([^\\/?#]+)/)[1],\r\n        baseURI: this.$root.baseURI,\r\n        passwordWrong: false,\r\n        needsPassword: false,\r\n        loading: true,\r\n        password: '',\r\n        content: '',\r\n        error: '',\r\n        config: {},\r\n        preview: false\r\n      }\r\n    },\r\n\r\n    computed: {\r\n      downloadsAvailable: function() {\r\n        return this.files.filter(f => !f.downloaded || f.metadata.retention !== 'one-time').length > 0\r\n      },\r\n      previewFiles: function() {\r\n        return this.files.filter(f => !!f.previewType);\r\n      }\r\n\r\n    },\r\n\r\n    methods: {\r\n      download(file) {\r\n        if(file.downloaded && file.metadata.retention === 'one-time') {\r\n          alert(this.$root.lang.oneTimeDownloadExpired);\r\n          return;\r\n        }\r\n        const aEl = document.createElement('a');\r\n        aEl.setAttribute('href', file.url);\r\n        aEl.setAttribute('download', file.metadata.name);\r\n        aEl.style.display = 'none';\r\n        document.body.appendChild(aEl);\r\n        aEl.click();\r\n        document.body.removeChild(aEl);\r\n        file.downloaded = true;\r\n      },\r\n\r\n      downloadAll(format) {\r\n        document.location.href = this.$root.baseURI\r\n          + '/files/' + this.sid + '++'\r\n          + MD5(\r\n            this.files\r\n              .filter(f => !f.downloaded || f.metadata.retention !== 'one-time')\r\n              .map(f => f.key).join()\r\n          ).toString() + '.' + format;\r\n\r\n        this.files.forEach(f => {\r\n          f.downloaded = true;\r\n        });\r\n      },\r\n\r\n      copied(file, $event) {\r\n        file.downloaded = $event === 'copied';\r\n      },\r\n\r\n      humanFileSize(fileSizeInBytes) {\r\n        let i = -1;\r\n        const byteUnits = [' kB', ' MB', ' GB', ' TB', 'PB', 'EB', 'ZB', 'YB'];\r\n        let size = fileSizeInBytes;\r\n        do {\r\n          size = size / 1024;\r\n          i++;\r\n        }\r\n        while(size > 1024);\r\n        return Math.max(size, 0.01).toFixed(2) + byteUnits[i];\r\n      },\r\n\r\n      newSession() {\r\n        document.location.href = this.$root.baseURI;\r\n      },\r\n\r\n      isFinite(value) {\r\n        if(typeof value !== 'number') return false;\r\n        return !(value !== value || value === Infinity || value === -Infinity);\r\n      },\r\n\r\n      fetchBucket() {\r\n        const xhr = new XMLHttpRequest();\r\n        xhr.open('GET', this.sid + '.json');\r\n        if(this.password) {\r\n          xhr.setRequestHeader('x-download-pass', this.password);\r\n        }\r\n        xhr.onload = () => {\r\n          if (xhr.status === 200) {\r\n            try {\r\n              const data = JSON.parse(xhr.responseText);\r\n              this.config = data.config;\r\n              this.files = data.items.map(f => {\r\n                return Object.assign(f, {\r\n                  downloaded: false,\r\n                  previewType: getPreviewType(f, this.config.maxPreviewSize)\r\n                });\r\n              });\r\n              this.loading = false;\r\n              this.needsPassword = false;\r\n            }\r\n            catch (e) {\r\n              this.error = e.toString();\r\n            }\r\n          } else if (xhr.status === 401) {\r\n            if(this.needsPassword) {\r\n              this.passwordWrong = true;\r\n            } else {\r\n              this.needsPassword = true;\r\n            }\r\n            this.loading = false;\r\n          } else {\r\n            this.error = `${ xhr.status } ${ xhr.statusText }: ${ xhr.responseText }`;\r\n          }\r\n        };\r\n        xhr.send();\r\n      },\r\n    },\r\n\r\n    beforeMount() {\r\n      this.fetchBucket();\r\n    }\r\n  }\r\n<\/script>\r\n\r\n<style scoped>\r\n  .download-app {\r\n    position: relative;\r\n  }\r\n\r\n  .btn-new-session {\r\n    position: absolute;\r\n    top: -60px;\r\n    right: 0;\r\n    z-index: 10;\r\n  }\r\n\r\n  .files tr {\r\n    transition: all 0.2s ease;\r\n  }\r\n\r\n  .files tr:hover {\r\n    background: #f9fafb !important;\r\n    transform: scale(1.01);\r\n  }\r\n\r\n  .file-icon {\r\n    width: 60px;\r\n    text-align: center;\r\n  }\r\n\r\n  .file-size {\r\n    color: #6b7280;\r\n    font-weight: 400;\r\n  }\r\n\r\n  .downloaded {\r\n    color: #10b981 !important;\r\n    font-size: 18px;\r\n  }\r\n\r\n  .btn-download-archive {\r\n    margin-top: -5px;\r\n  }\r\n\r\n  .btn-download-archive .btn {\r\n    margin-left: 8px;\r\n  }\r\n\r\n  @media (max-width: 768px) {\r\n    .btn-new-session {\r\n      position: relative;\r\n      top: auto;\r\n      right: auto;\r\n      margin-bottom: 20px;\r\n      display: block;\r\n      width: 100%;\r\n    }\r\n  }\r\n</style>"],sourceRoot:""}]);const s=i},759:(e,t,n)=>{"use strict";n(459);var r=n(257),a=n.n(r),o=n(751),i=n.n(o);n(280),n(908),n(434),n(98),n(843),n(183),n(207);const s={props:["file"],computed:{iconClass(){const e=this.file.type||this.file.metadata&&this.file.metadata.type;return e?e.startsWith("image")?"regular/file-image":e.startsWith("text")?"regular/file-alt":e.startsWith("video")?"regular/file-video":e.startsWith("audio")?"regular/file-audio":"application/pdf"===e?"regular/file-pdf":e.startsWith("application")?"regular/file-archive":"regular/file":"regular/file"},isImageBlob(){return!(!URL&&!webkitURL)&&this.file instanceof File&&this.file.type.startsWith("image")},blobUrl(){if(this.isImageBlob)return(URL||webkitURL).createObjectURL(this.file)}}};var l=n(486);const c=(0,l.A)(s,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"file-icon"},[e.isImageBlob?e._e():t("icon",{attrs:{name:e.iconClass,scale:"3"}}),e.isImageBlob?t("img",{attrs:{src:e.blobUrl}}):e._e()],1)}),[],!1,null,null,null).exports;n(547),n(794),n(211);const d={name:"Clipboard",props:{value:{type:String,required:!0}},data:()=>({state:"pristine"}),methods:{copy(){let e=document.createElement("textarea");Object.assign(e.style,{position:"absolute",left:"-200%"}),e.value=this.value,document.body.appendChild(e);let t=!1;try{e.select(),t=document.execCommand("copy")}catch(e){alert(this.$root.lang.oldBrowserError),console.error(e)}document.body.removeChild(e),this.state=t?"copied":"error",this.$emit("change",this.state)}}},u=(0,l.A)(d,(function(){var e=this,t=e._self._c;return t("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){return t.stopPropagation(),e.copy()}}},[e._t("default",(function(){return["pristine"===e.state?t("icon",{staticClass:"fa-fw",attrs:{name:"copy"}}):e._e(),"copied"===e.state?t("icon",{staticClass:"fa-fw",attrs:{name:"check"}}):e._e(),"error"===e.state?t("icon",{staticClass:"fa-fw",attrs:{name:"exclamation-triangle"}}):e._e(),e._t("text",(function(){return[e._v(" "+e._s(e.$root.lang.clipboard))]}))]}),{state:e.state})],2)}),[],!1,null,null,null).exports,p={props:{hasHeader:{type:Boolean,default:!1},hasFooter:{type:Boolean,default:!1}},mounted(){this.$nextTick((function(){this.$refs.modal.focus()}))},methods:{close(){this.$emit("close")}}},f=(0,l.A)(p,(function(){var e=this,t=e._self._c;return t("div",{ref:"modal",staticClass:"modal fade in background-darken",staticStyle:{display:"block"},attrs:{tabindex:"-1",role:"dialog"},on:{click:function(t){return t.target!==t.currentTarget?null:e.close()},keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.close()},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])||"button"in t&&0!==t.button?null:e.$emit("prev")},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"right",39,t.key,["Right","ArrowRight"])||"button"in t&&2!==t.button?null:e.$emit("next")}]}},[t("div",{staticClass:"modal-dialog modal-fluid",attrs:{role:"document"}},[t("div",{staticClass:"modal-content"},[e.hasHeader?t("div",{staticClass:"modal-header"},[t("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"},on:{click:function(t){return e.close()}}},[t("span",{attrs:{"aria-hidden":"true"}},[e._v("Ã—")])]),t("h4",{staticClass:"modal-title"},[e._t("header",(function(){return[e._v(" Modal")]}))],2)]):e._e(),t("div",{staticClass:"modal-body"},[e._t("body",(function(){return[e._v(" Body")]}))],2),e.hasFooter?t("div",{staticClass:"modal-footer"},[e._t("footer")],2):e._e()])])])}),[],!1,null,null,null).exports;var h=n(842);h.A.register({"arrow-left":{width:448,height:512,paths:[{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0l-194.4-194.3c-9.4-9.4-9.4-24.6 0-33.9l194.4-194.4c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-0.4 34.3l-120.5 114.8h287.4c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24h-287.4l120.5 114.8c9.8 9.3 10 24.8 0.4 34.3z"}]}}),h.A.register({"arrow-right":{width:448,height:512,paths:[{d:"M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0l194.4 194.3c9.4 9.4 9.4 24.6 0 33.9l-194.4 194.4c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 0.4-34.3l120.5-114.8h-287.4c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4l-120.5-114.8c-9.8-9.3-10-24.8-0.4-34.3z"}]}}),h.A.register({"undo-alt":{width:512,height:512,paths:[{d:"M255.5 8c136.8-0.2 248.5 111.2 248.5 248 0 137-111 248-248 248-63.9 0-122.2-24.2-166.2-63.9-5.1-4.6-5.4-12.6-0.5-17.4l39.7-39.7c4.5-4.5 11.6-4.7 16.4-0.6 30.6 26.9 69.5 41.6 110.6 41.6 93.8 0 167.2-76 168-166.6 0.8-95.5-77.1-170.2-169.5-169.4-42.4 0.4-82.4 16.4-113.2 45.3l41.8 41.8c15.1 15.1 4.4 41-17 41h-134.1c-13.3 0-24-10.7-24-24v-134.1c0-21.4 25.9-32.1 41-17l35.7 35.7c44.4-42.5 104.6-68.6 170.9-68.7z"}]}});const m={components:{Modal:f},props:["preview","files","maxSize"],data:()=>({previewText:"",lineWrap:!1,current:!1}),computed:{currentIndex:function(){return this.files.indexOf(this.current)}},watch:{preview:function(e){this.current=e},current:function(e,t){!1===e&&this.$emit("close"),"text"===e.previewType&&e!==t&&this.getPreviewText()}},methods:{next(){this.currentIndex>=this.files.length-1||(this.current=this.files[this.currentIndex+1])},prev(){this.currentIndex<=0||(this.current=this.files[this.currentIndex-1])},getPreviewText(){this.previewText="";const e=new XMLHttpRequest;e.open("GET",this.current.url),e.onload=()=>{200===e.status?this.previewText=e.responseText:this.previewText=`${e.status} ${e.statusText}: ${e.responseText}`},e.send()}}},v=(0,l.A)(m,(function(){var e=this,t=e._self._c;return e.current?t("modal",{staticClass:"preview-modal",attrs:{"has-header":!0},on:{close:function(t){e.current=!1},next:e.next,prev:e.prev}},[t("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[t("p",[t("strong",[e._v(e._s(e.current.metadata.name))])]),t("div",[t("small",[e._v(e._s(e.currentIndex+1)+" / "+e._s(e.files.length))]),t("span",{staticClass:"btn-group"},[t("a",{directives:[{name:"show",rawName:"v-show",value:e.currentIndex>0,expression:"currentIndex > 0"}],staticClass:"btn btn-sm btn-default",attrs:{title:"previous"},on:{click:e.prev}},[t("icon",{attrs:{name:"arrow-left"}})],1),t("a",{directives:[{name:"show",rawName:"v-show",value:e.currentIndex<e.files.length-1,expression:"currentIndex < files.length-1"}],staticClass:"btn btn-sm btn-default",attrs:{title:"next"},on:{click:e.next}},[t("icon",{attrs:{name:"arrow-right"}})],1),t("a",{directives:[{name:"show",rawName:"v-show",value:"text"===e.current.previewType,expression:"current.previewType === 'text'"}],staticClass:"btn btn-sm btn-default",class:{active:e.lineWrap},attrs:{title:"toggle line wrap"},on:{click:function(t){e.lineWrap=!e.lineWrap}}},[t("icon",{attrs:{name:"undo-alt",flip:"vertical"}})],1)])])]),t("div",{attrs:{slot:"body"},slot:"body"},["image"===e.current.previewType?t("div",{staticStyle:{"text-align":"center"}},[t("img",{staticStyle:{"max-width":"100%",height:"auto"},attrs:{src:e.current.url}})]):e._e(),"text"===e.current.previewType?t("div",[t("pre",{style:{"white-space":e.lineWrap?"pre-wrap":"pre"}},[e._v(e._s(e.previewText))])]):e._e(),!1===e.current.previewType?t("p",{staticStyle:{"text-align":"center"}},[t("strong",{staticClass:"text-danger"},[e._v(e._s(e.$root.lang.noPreviewAvailable))])]):e._e()])]):e._e()}),[],!1,null,null,null).exports;n(548),n(595),n(560),h.A.register({eye:{width:576,height:512,paths:[{d:"M572.5 241.4c2.2 4.4 3.5 9.4 3.5 14.6 0 5.2-1.2 10.2-3.5 14.6-54.2 105.8-161.6 177.4-284.5 177.4s-230.3-71.6-284.5-177.4c-2.2-4.4-3.5-9.4-3.5-14.6 0-5.2 1.2-10.2 3.5-14.6 54.2-105.8 161.6-177.4 284.5-177.4s230.3 71.6 284.5 177.4zM288 400c0 0 0 0 0.1 0 79.4 0 143.9-64.5 143.9-143.9v-0.1c0-79.5-64.5-144-144-144s-144 64.5-144 144 64.5 144 144 144zM288 160c0.1 0 0.2 0 0.2 0 52.9 0 95.8 42.9 95.8 95.8s-42.9 95.8-95.8 95.8-95.8-42.9-95.8-95.8c0-8.7 1.2-17.1 3.3-25.1 7.9 5.8 17.7 9.3 28.3 9.3 26.4 0 47.8-21.4 47.8-47.8 0-10.6-3.4-20.4-9.3-28.3 8-2.3 16.5-3.7 25.3-3.8z"}]}});const w={name:"app",components:{FileIcon:c,Clipboard:u,PreviewModal:v},data(){return{files:[],sid:document.location.pathname.match(/^.*\/([^\/?#]+)/)[1],baseURI:this.$root.baseURI,passwordWrong:!1,needsPassword:!1,loading:!0,password:"",content:"",error:"",config:{},preview:!1}},computed:{downloadsAvailable:function(){return this.files.filter((e=>!e.downloaded||"one-time"!==e.metadata.retention)).length>0},previewFiles:function(){return this.files.filter((e=>!!e.previewType))}},methods:{download(e){if(e.downloaded&&"one-time"===e.metadata.retention)return void alert(this.$root.lang.oneTimeDownloadExpired);const t=document.createElement("a");t.setAttribute("href",e.url),t.setAttribute("download",e.metadata.name),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t),e.downloaded=!0},downloadAll(e){document.location.href=this.$root.baseURI+"/files/"+this.sid+"++"+i()(this.files.filter((e=>!e.downloaded||"one-time"!==e.metadata.retention)).map((e=>e.key)).join()).toString()+"."+e,this.files.forEach((e=>{e.downloaded=!0}))},copied(e,t){e.downloaded="copied"===t},humanFileSize(e){let t=-1,n=e;do{n/=1024,t++}while(n>1024);return Math.max(n,.01).toFixed(2)+[" kB"," MB"," GB"," TB","PB","EB","ZB","YB"][t]},newSession(){document.location.href=this.$root.baseURI},isFinite:e=>"number"==typeof e&&!(e!=e||e===1/0||e===-1/0),fetchBucket(){const e=new XMLHttpRequest;e.open("GET",this.sid+".json"),this.password&&e.setRequestHeader("x-download-pass",this.password),e.onload=()=>{if(200===e.status)try{const t=JSON.parse(e.responseText);this.config=t.config,this.files=t.items.map((e=>{return Object.assign(e,{downloaded:!1,previewType:(t=e,n=this.config.maxPreviewSize,!(!t||!t.metadata)&&"one-time"!==t.metadata.retention&&!(t.size>n)&&(t.metadata.type&&t.metadata.type.match(/^image\/.*/)?"image":!!(t.metadata.type&&t.metadata.type.match(/(text\/|xml|json|javascript|x-sh)/)||t.metadata.name&&t.metadata.name.match(/\.(jsx|vue|sh|pug|less|scss|sass|c|h|conf|log|bat|cmd|lua|class|java|py|php|yml|sql|md)$/))&&"text"))});var t,n})),this.loading=!1,this.needsPassword=!1}catch(e){this.error=e.toString()}else 401===e.status?(this.needsPassword?this.passwordWrong=!0:this.needsPassword=!0,this.loading=!1):this.error=`${e.status} ${e.statusText}: ${e.responseText}`},e.send()}},beforeMount(){this.fetchBucket()}};n(380);const g=(0,l.A)(w,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"download-app"},[t("a",{staticClass:"btn btn-sm btn-info btn-new-session",attrs:{title:e.$root.lang.newUpload},on:{click:function(t){return e.newSession()}}},[t("icon",{staticClass:"fa-fw",attrs:{name:"cloud-upload-alt"}}),t("span",{staticClass:"hidden-xs"},[e._v(" "+e._s(e.$root.lang.newUpload))])],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.error,expression:"error"}],staticClass:"alert alert-danger"},[t("strong",[t("icon",{staticClass:"fa-fw",attrs:{name:"exclamation-triangle"}}),e._v(" "+e._s(e.error))],1)]),e.needsPassword?t("div",{staticClass:"well"},[t("h3",[e._v(e._s(e.$root.lang.password))]),t("div",{staticClass:"form-group"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password",autofocus:""},domProps:{value:e.password},on:{keyup:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.password.length&&e.fetchBucket()},input:function(t){t.target.composing||(e.password=t.target.value)}}})]),t("p",{directives:[{name:"show",rawName:"v-show",value:e.passwordWrong,expression:"passwordWrong"}],staticClass:"text-danger"},[t("strong",[e._v(e._s(e.$root.lang.accessDenied))])]),t("button",{staticClass:"decrypt btn btn-primary",attrs:{disabled:e.password.length<1},on:{click:function(t){return e.fetchBucket()}}},[t("icon",{staticClass:"fa-fw",attrs:{name:"key"}}),e._v(" "+e._s(e.$root.lang.decrypt))],1)]):e._e(),e.needsPassword||e.loading?e._e():t("div",{staticClass:"panel panel-primary"},[t("div",{staticClass:"panel-heading"},[t("strong",[e._v(e._s(e.$root.lang.files))]),e.downloadsAvailable?t("div",{staticClass:"pull-right btn-group btn-download-archive"},[t("a",{staticClass:"btn btn-sm btn-default",attrs:{title:e.$root.lang.zipDownload,tabindex:"0",role:"button"},on:{click:function(t){return e.downloadAll("zip")},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.downloadAll("zip"))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:(t.preventDefault(),e.downloadAll("zip"))}]}},[t("icon",{staticClass:"fa-fw",attrs:{name:"download"}}),e._v(" zip")],1),t("a",{staticClass:"btn btn-sm btn-default",attrs:{title:e.$root.lang.tarGzDownload,tabindex:"0",role:"button"},on:{click:function(t){return e.downloadAll("tar.gz")},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.downloadAll("tar.gz"))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:(t.preventDefault(),e.downloadAll("tar.gz"))}]}},[t("icon",{staticClass:"fa-fw",attrs:{name:"download"}}),e._v(" tar.gz")],1)]):e._e()]),t("div",{staticClass:"panel-body"},[t("table",{staticClass:"table table-hover table-striped files"},[t("tbody",e._l(e.files,(function(n){return t("tr",{staticStyle:{cursor:"pointer"},attrs:{tabindex:"0",role:"button"},on:{click:function(t){return e.download(n)},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.download(n))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:(t.preventDefault(),e.download(n))}]}},[t("td",{staticClass:"file-icon"},[t("file-icon",{attrs:{file:n}})],1),t("td",[t("div",{staticClass:"pull-right btn-group"},[t("clipboard",{staticClass:"btn btn-sm btn-default",attrs:{value:e.baseURI+n.url,title:e.$root.lang.copyToClipboard},on:{change:function(t){return e.copied(n,t)}}},[t("a",[t("icon",{attrs:{name:"copy"}})],1)]),n.previewType?t("a",{staticClass:"btn btn-sm btn-default",attrs:{title:e.$root.lang.preview},on:{click:function(t){t.preventDefault(),t.stopPropagation(),e.preview=n}}},[t("icon",{attrs:{name:"eye"}})],1):e._e()],1),t("i",{directives:[{name:"show",rawName:"v-show",value:n.downloaded,expression:"file.downloaded"}],staticClass:"pull-right fa fa-check text-success downloaded"}),t("p",[t("strong",[e._v(e._s(n.metadata.name))]),isFinite(n.size)?t("small",{staticClass:"file-size"},[e._v("("+e._s(e.humanFileSize(n.size))+")")]):e._e()]),t("p",[e._v(e._s(n.metadata.comment))])])])})),0)])])]),t("preview-modal",{attrs:{preview:e.preview,files:e.previewFiles,"max-size":e.config.maxPreviewSize},on:{close:function(t){e.preview=!1}}})],1)}),[],!1,null,"08482814",null).exports;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),a().component("icon",h.A),new(a())({el:"#download",data:{baseURI:document.head.getElementsByTagName("base")[0].href.replace(/\/$/,""),lang:{}},async beforeCreate(){try{this.lang=await async function(){return new Promise(((e,t)=>{const n=new XMLHttpRequest;n.open("GET","lang.json"),n.onload=()=>{if(200===n.status)try{e(JSON.parse(n.responseText))}catch(e){t(e)}else t(new Error(`HTTP-GET error: ${n.status} ${n.statusText}`))},n.send()}))}()}catch(e){alert(e)}},render:e=>e(g)}),window.GoKabootar_VERSION="#ce021cdd29"}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var o=n[e]={id:e,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.exports}r.m=t,e=[],r.O=(t,n,a,o)=>{if(!n){var i=1/0;for(d=0;d<e.length;d++){for(var[n,a,o]=e[d],s=!0,l=0;l<n.length;l++)(!1&o||i>=o)&&Object.keys(r.O).every((e=>r.O[e](n[l])))?n.splice(l--,1):(s=!1,o<i&&(i=o));if(s){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[n,a,o]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={467:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var a,o,[i,s,l]=n,c=0;if(i.some((t=>0!==e[t]))){for(a in s)r.o(s,a)&&(r.m[a]=s[a]);if(l)var d=l(r)}for(t&&t(n);c<i.length;c++)o=i[c],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(d)},n=self.webpackChunkGoKabootar=self.webpackChunkGoKabootar||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=r.O(void 0,[76],(()=>r(759)));a=r.O(a)})();
//# sourceMappingURL=download.js.map